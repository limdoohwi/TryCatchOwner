<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.trycatch.owner.mappers.orderMapper">  
	<select id="getOrder_Information" parameterType="hashMap" resultType="Order_InformationDTO">
	   select p.menu_payment_no, p.order_name, p.order_tel, p.menu_reserve_time, p.menu_payment_date, p.menu_total_price, s.store_name from 
   		menu_payment p, store s where p.store_no = s.store_no
	    <if test="search_order_info != null">
	    	<if test="search_order_info != ''">
		    	and p.store_no = #{store_no} and p.order_name = #{search_order_info}
		    	<if test="isAsc != null">
					<if test='isAsc == "false"'>
						order by menu_reserve_time desc
			     	</if>
					<if test='isAsc == "true"'>
						order by menu_reserve_time asc
					</if>
				</if>
		    </if>
		     <if test="search_order_info == ''">
		    	and p.store_no = #{store_no}
		    	<if test="isAsc != null">
					<if test='isAsc == "false"'>
						order by menu_reserve_time desc
					</if>
					<if test='isAsc == "true"'>
							order by menu_reserve_time asc
					</if>
				</if>
		    </if>
	    </if>
	    <if test="search_order_info == null">
	    	 and p.store_no = #{store_no} and date(p.menu_reserve_time) = curdate()
		    	<if test="isAsc != null">
					<if test='isAsc == "false"'>
						order by menu_reserve_time desc
					</if>
					<if test='isAsc == "true"'>
						order by menu_reserve_time asc
					</if>
				</if>
	    </if>
	</select>
	
	<select id="getMenuOrder_withMenu_Payment_no" parameterType="int" resultType="Menu_OrderDTO">
	      select m.menu_name, o.menu_count, o.menu_option from menu_order o, menu m 
   			where o.menu_no = m.menu_num and o.menu_payment_no = #{menu_payment_no}
	</select>
	
	<select id="getMenu_Payment_noList" parameterType="hashMap" resultType="int">
		select menu_payment_no from menu_payment where store_no = #{store_no} and date(menu_payment_date) = curdate() order by menu_payment_date desc
	</select>
</mapper>
